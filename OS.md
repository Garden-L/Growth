# OS

## 빌드과정
빌드란 작성한 프로그램을 기계어로 번역해서 실행파일을 만들어내는 과정이다.

### 1. 소스코드 작성
C/C++로 작성 한다.
<img width="303" alt="image" src="https://user-images.githubusercontent.com/56042451/193445367-30c3be4c-928f-48c2-9d4c-f8f3d0ae3cdf.png">

### 2. Proprocessing (전처리)
전처리란 컴파일 전 코드를 적절한 상태로 준비 및 처리하는 일이다. 헤더파일 불러오기, define문 치환, 주석 제거 등을 처리한다. 전처리는 전처리기가 처리하게 되고 #으로 시작하는 구문 + 주석을 처리한다고 생각하면 된다. cpp 명령으로 전처리를 실행할 수 있다. 전처리를 실행 후에는 .i 파일이 생성되게 된다.
<img width="682" alt="image" src="https://user-images.githubusercontent.com/56042451/193445422-f1506a21-fcd1-4a40-9264-173bc2dca7f2.png">
```c
$ cpp test.c > test.i
또는
$ gcc -E test.c > test.i
```

#### 자세한 것은 https://www.ibm.com/docs/ko/aix/7.2?topic=c-cpp-command 


### 3. compile (컴파일)
전처리된 파일을 컴파일러가 현재 프로세서에 맞는 어셈블리 코드로 번역해준다. 전처리된 파일(.i)을 어셈블리 파일(.s)로 번역한다.

```c
$ gcc -S test.i
```
![image](https://user-images.githubusercontent.com/56042451/193445716-da16208e-e28a-4381-a7f1-3230425c2e0d.png)


### 4. Assemble
컴파일된 파일을 어셈블러가 Machine Code(이진수)로 번역하여 실제 기계가 읽을 수 있게 한다. 어셈블리파일(.s)를 목적파일(.o)파일로 번역한다. 

```c
$ as -o test.o test.s
```
<img width="703" alt="image" src="https://user-images.githubusercontent.com/56042451/193446080-3d0a3cf2-4465-4c01-b861-1de4456d50ec.png">


### 5. Linkng
생성된 목적파일들을 연결하는 작업이다. 여러 작업들을 분할했다면 이 과정에서 관련있는 서로의 파일들이 엮이게 된다. 또한 정적라이브러리도 여기서 합쳐지게 된다. 이 과정을 마무리로 실행파일(.out, .exe ...)가 생기게된다.

```c
$ gcc -o a.out test.o
```

## Process comunication
프로세스는 시스템내에서 독립적으로 실행되기도 하지만, 서로 데이터를 주고받으며 협업하기도 한다. 데이터를 주고받을 때는 프로세스끼리 통신을 해야한다. 또한 프로세스 내부에서 스레드끼리 통신이 가능하고, 소켓을 이용하여 각 호스트의 프로세스끼리도 통신이 가능하다.

### 1. 통신종류
* 프로세스 내 통신
  + 하나의 프로세스에서 두 개 이상의 스레드가 존재하는 경우 프로세스 내부에서 스레드 끼리 데이터를 주고받는 경우.
    - 전역변수 또는 파일 사용
* 프로세스 간 통신
  + 같은 시스템 내에서 두 개 이상의 프로세스 끼리 통신하는 경우
    - 메모리를 사용 (메인메모리: shared memory, 보조메모리: 파일, pipe(내부적으로파일))
* 네트워크를 이용한 통신
  + 여러 컴퓨터 간 네트워크로 연결되어 있는 경우
    - 소켓 사용, 원격 프로시져 호출(RPC)

프로세스 간 통신(Inter Process Comunication)이 스레드를 이용한 프로세스 내 통신 보다 어려운 이유?
스레드는 서로 메모리와 자원을 공유하기 때문에 같은 변수에 접근이 가능하다. 하지만 프로세스는 서로 다른 메모리 공간을 사용하기 때문에 별도의 공간을 만들어서 데이터 통신을 해야하기 때문에 프로세스 간 통신이 어렵다.

### 2. 통신 방향의 분류
통신 장치들은 데이터가 전송되는 방향에 따라 각기 불리는 이름이 다르다.

#### 2-1. 양방향 통신(Duplex communication)
양방향 통신은 동시에 양쪽 방향으로 전송할 수 있는 구조이다. 양방향을 구현하기 위해서는 변수가 두 개 있어야 가능하다. 1개만 사용하면 동시에 보낼 시 빨리온 데이터는 늦게온 데이터에 덮혀 쓰여지기 때문이다.

#### 2-2. 단방향 통신 (simplex communication)
단방향 통신은 한쪽 방향으로만 데이터를 전송할 수 있는 구조. 한쪽은 데이터를 무조건 보내고 한 쪽은 데이터를 무조건 받기만 한다.

#### 2-3. 반양방향 통신 (half-duplex communication)
반양방향 통신은 양쪽 방향으로 데이터 전송이 가능하지만, 동시 전송이 불가능한 형대이다. 한쪽에서 데이터를 보내고 있다면 한쪽에서는 데이터 전송 행위가 불가능 하다.


